<section class="grid-two" id="controlPlaneSection">
  <article class="panel" id="cpPanel">
    <h2>Control Plane</h2>
    <p class="panel-hint">
      Real-time transactional AI tuning for live operations. Secondary and
      low-frequency settings stay in progressive disclosure.
    </p>

    <div class="form-row form-row-center form-row-mb-3">
      <span id="cpModeChip" class="chip pending">MODE</span>
      <span id="cpResponseContract" class="chip"
        >Active contract: 1 message / 4 lines.</span
      >
    </div>
    <p id="cpCapabilitiesLine" class="panel-hint panel-hint-mb-4">
      Loading capabilities...
    </p>

    <section
      id="cpOperationalControlSection"
      aria-labelledby="cpOperationalControlHeading"
      class="section-surface"
    >
      <div
        class="form-row form-row-center form-row-between form-row-gap-3 form-row-mb-2"
      >
        <h3 id="cpOperationalControlHeading" class="heading-reset">
          Operational Control
        </h3>
        <span id="cpAgentStatusChip" class="chip pending">RUNNING</span>
      </div>
      <p id="cpAgentStatusHint" class="panel-hint panel-hint-mb-3">
        Operational agent.
      </p>
      <div class="form-row form-row-gap-2 form-row-m0">
        <button id="cpSuspendBtn" class="btn btn-danger" type="button">
          Panic Suspend
        </button>
        <button id="cpResumeBtn" class="btn btn-secondary" type="button">
          Resume Agent
        </button>
      </div>
    </section>

    <section
      id="cpChannelDirectivesSection"
      aria-labelledby="cpChannelDirectivesHeading"
      class="section-surface"
    >
      <div
        class="form-row form-row-center form-row-between form-row-gap-3 form-row-mb-2"
      >
        <div class="form-row form-row-center form-row-gap-2 form-row-m0">
          <h3 id="cpChannelDirectivesHeading" class="heading-reset">
            Channel Directives
          </h3>
          <span id="cpChannelConfigStatusChip" class="chip pending"
            >MODEL DEFAULT</span
          >
        </div>
        <div class="form-row form-row-gap-2 form-row-m0">
          <button
            id="cpLoadChannelConfigBtn"
            class="btn btn-secondary"
            type="button"
          >
            Load Channel
          </button>
          <button
            id="cpSaveChannelConfigBtn"
            class="btn btn-primary"
            type="button"
          >
            Apply Directives
          </button>
        </div>
      </div>

      <p id="cpChannelConfigHint" class="panel-hint panel-hint-m0-mb-3">
        Overrides persisted in <code>channels_config</code>.
      </p>

      <div class="form-row form-row-wrap form-row-mb-2">
        <div class="form-group form-group-min-170">
          <label for="cpChannelConfigId">Channel</label>
          <input
            id="cpChannelConfigId"
            class="form-control"
            type="text"
            value="default"
          />
        </div>
        <div class="form-group form-group-min-150">
          <label for="cpChannelTemperature">Temperature</label>
          <input
            id="cpChannelTemperature"
            class="form-control"
            type="number"
            min="0"
            max="2"
            step="0.01"
            placeholder="0.15"
          />
        </div>
        <div class="form-group form-group-min-150">
          <label for="cpChannelTopP">Top P</label>
          <input
            id="cpChannelTopP"
            class="form-control"
            type="number"
            min="0"
            max="1"
            step="0.01"
            placeholder="auto"
          />
        </div>
        <div class="form-group form-group-min-220">
          <label class="toggle-switch toggle-switch-mt-14">
            <input id="cpChannelAgentPaused" type="checkbox" />
            <span class="toggle-slider"></span>
            Pause/Silence on this channel
          </label>
        </div>
      </div>
    </section>

    <details class="advanced-settings">
      <summary>Identity + Agent Notes</summary>
      <div class="advanced-settings-content">
        <div class="form-row form-row-center form-row-gap-2 form-row-mb-2">
          <span id="cpChannelIdentityStatusChip" class="chip pending"
            >IDENTITY CLEAR</span
          >
          <span id="cpAgentNotesStatusChip" class="chip pending"
            >NOTES CLEAR</span
          >
        </div>

        <p id="cpChannelIdentityHint" class="panel-hint panel-hint-m0-mb-1">
          Identity persisted in <code>channel_identity</code> and applied to the
          system prompt.
        </p>
        <p id="cpAgentNotesHint" class="panel-hint panel-hint-m0-mb-3">
          Notes persisted in <code>agent_notes</code> and injected into the
          prompt.
        </p>

        <div class="form-row form-row-wrap form-row-mb-2">
          <div class="form-group form-group-min-220">
            <label for="cpChannelPersonaName">Persona Name</label>
            <input
              id="cpChannelPersonaName"
              class="form-control"
              type="text"
              maxlength="80"
              placeholder="e.g. Byte Coach"
            />
          </div>
          <div class="form-group form-group-min-280">
            <label for="cpChannelTone">Tone</label>
            <input
              id="cpChannelTone"
              class="form-control"
              type="text"
              maxlength="160"
              placeholder="e.g. tactical, objective, spoiler-free"
            />
          </div>
        </div>

        <div class="form-row form-row-wrap form-row-mb-2">
          <div class="form-group form-group-min-260 u-flex-1">
            <label for="cpChannelEmoteVocab">Emote Vocab (csv)</label>
            <input
              id="cpChannelEmoteVocab"
              class="form-control"
              type="text"
              maxlength="720"
              placeholder="e.g. PogChamp, Kappa, LUL"
            />
          </div>
        </div>

        <div class="form-group form-group-mb-2">
          <label for="cpChannelLore">Lore / Continuity</label>
          <textarea
            id="cpChannelLore"
            class="form-control"
            rows="3"
            maxlength="1200"
            placeholder="Recurring channel context to keep reply continuity."
          ></textarea>
        </div>
        <div class="form-group form-group-mb-0">
          <label for="cpAgentNotes">Operational Notes</label>
          <textarea
            id="cpAgentNotes"
            class="form-control"
            rows="4"
            placeholder="e.g. Prioritize streamer lore/context. Avoid aggressive backseating."
          ></textarea>
        </div>
      </div>
    </details>

    <section
      id="cpGoalsSchedulerSection"
      aria-labelledby="cpGoalsSchedulerHeading"
      class="form-row-mt-4"
    >
      <div class="form-row form-row-between form-row-center form-row-mb-2">
        <h3 id="cpGoalsSchedulerHeading" class="heading-reset">
          Goals Scheduler
        </h3>
        <button id="cpAddGoalBtn" class="btn btn-secondary" type="button">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <line x1="12" y1="5" x2="12" y2="19"></line>
            <line x1="5" y1="12" x2="19" y2="12"></line>
          </svg>
          Add Goal
        </button>
      </div>
      <p class="panel-hint panel-hint-mb-2">
        Goal cards define intent, urgency and KPI contract before persistence.
      </p>
      <ul id="cpGoalsList" class="events-list"></ul>
    </section>

    <details class="advanced-settings">
      <summary>Advanced Budget, Cooldowns and Webhooks</summary>
      <div class="advanced-settings-content">
        <div class="form-row form-row-wrap form-row-mb-3">
          <div class="form-group form-group-min-170">
            <label class="toggle-switch">
              <input id="cpAutonomyEnabled" type="checkbox" />
              <span class="toggle-slider"></span>
              Global Autonomy
            </label>
          </div>
        </div>

        <div class="form-row form-row-wrap form-row-mb-4">
          <div class="form-group form-group-min-140">
            <label for="cpHeartbeatInterval">Heartbeat (s)</label>
            <input
              id="cpHeartbeatInterval"
              class="form-control"
              type="number"
              min="15"
              max="3600"
              step="1"
            />
          </div>
          <div class="form-group form-group-min-140">
            <label for="cpMinCooldown">Cooldown (s)</label>
            <input
              id="cpMinCooldown"
              class="form-control"
              type="number"
              min="15"
              max="3600"
              step="1"
            />
          </div>
          <div class="form-group form-group-min-140">
            <label for="cpActionIgnoreAfter">Auto-ignore (s)</label>
            <input
              id="cpActionIgnoreAfter"
              class="form-control"
              type="number"
              min="60"
              max="86400"
              step="1"
            />
          </div>
        </div>

        <div class="form-row form-row-wrap">
          <div class="form-group form-group-min-140">
            <label for="cpBudget10m">Budget 10m</label>
            <input
              id="cpBudget10m"
              class="form-control"
              type="number"
              min="0"
              max="100"
              step="1"
            />
          </div>
          <div class="form-group form-group-min-140">
            <label for="cpBudget60m">Budget 60m</label>
            <input
              id="cpBudget60m"
              class="form-control"
              type="number"
              min="0"
              max="600"
              step="1"
            />
          </div>
          <div class="form-group form-group-min-140">
            <label for="cpBudgetDaily">Daily Budget</label>
            <input
              id="cpBudgetDaily"
              class="form-control"
              type="number"
              min="0"
              max="5000"
              step="1"
            />
          </div>
        </div>

        <div class="section-divider-top">
          <h4 class="heading-xs-strong">Outbound Webhooks</h4>
          <p class="panel-hint panel-hint-mb-3">
            Configure an endpoint to receive agent events (Phase 18).
          </p>
          <div class="form-row form-row-wrap form-row-mb-2">
            <div class="form-group form-group-min-220 u-flex-2">
              <label for="cpWebhookUrl">Webhook URL</label>
              <input
                id="cpWebhookUrl"
                class="form-control"
                type="url"
                placeholder="https://api.example.com/webhooks/byte"
              />
            </div>
            <div class="form-group form-group-min-180 u-flex-1">
              <label for="cpWebhookSecret">HMAC Secret (optional)</label>
              <input
                id="cpWebhookSecret"
                class="form-control"
                type="password"
                placeholder="Secret for sha256 signing"
              />
            </div>
          </div>
          <div class="form-row form-row-center form-row-between form-row-gap-3">
            <label class="toggle-switch">
              <input id="cpWebhookActive" type="checkbox" checked />
              <span class="toggle-slider"></span>
              Enable Dispatch
            </label>
            <button
              id="cpWebhookTestBtn"
              class="btn btn-secondary"
              type="button"
            >
              Test Webhook
            </button>
          </div>
        </div>
      </div>
    </details>

    <div class="form-row form-row-mt-5">
      <button id="cpSaveBtn" class="btn btn-primary" type="button">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="16"
          height="16"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <path
            d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"
          ></path>
          <polyline points="17 21 17 13 7 13 7 21"></polyline>
          <polyline points="7 3 7 8 15 8"></polyline>
        </svg>
        Save Config
      </button>
      <button id="cpReloadBtn" class="btn btn-secondary" type="button">
        Reload
      </button>
    </div>
    <p id="cpFeedbackMsg" class="panel-hint event-level-info panel-hint-mt-2">
      Waiting for configuration...
    </p>
  </article>
</section>
